<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">


<h:head>
	<ui:include src="/pages/commons/scripts.xhtml" />
</h:head>

<h:body>
	<div class="ui-fluid">

		<f:event type="preRenderView"
			listener="#{adminPerfilesController.initializer}" />

		<h:form id="formPerfiles">


			<p:growl id="messages" showSummary="true" showDetail="true"
				skipDetailIfEqualsSummary="true" />

			<ui:include src="/pages/commons/navbar.xhtml" />

			<div class="grid sample-layout">

				<div class="flex" style="width: 100%">
					<ui:include src="/pages/commons/header.xhtml" />


					<div class="col-8 flex-grow-1" style="background-color: black;">
						<div class="grid">
							<div class="col-12">

								<div class="col-2">
									<p:commandButton oncomplete="PF('dlgPerfiles').show()"
										action="#{adminPerfilesController.limpiarComponentes}"
										immediate="true" update="formAddUpdatePerfil:pblPerfiles"
										value="Agregar" />
								</div>


								<p:dataTable id="tblPerfiles" var="perfil"
									widgetVar="tblPerfiles"
									value="#{adminPerfilesController.perfiles}" rows="20"
									emptyMessage="No se encontraron registros de perfiles..."
									paginator="true" rowsPerPageTemplate="20,50,100"
									paginatorPosition="bottom"
									filteredValue="#{adminPerfilesController.perfilesFiltrados}"
									paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
									currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros">

									<f:facet name="header">
										Listado de Perfiles
									</f:facet>


									<p:column headerText="Nombre" filterBy="#{perfil.nombre}"
										filterMatchMode="contains">
										<p:outputLabel value="#{perfil.nombre}" />
									</p:column>

									<p:column headerText="Fecha de Creacion">
										<p:outputLabel value="#{perfil.fechaCreacion}"
											converter="localDateTimeConverter" />
									</p:column>

									<p:column headerText="Estatus" filterBy="#{perfil.estatus}"
										filterMatchMode="exact">
										<f:facet name="filter">
											<p:selectOneMenu onchange="PF('tblPerfiles').filter()">
												<f:selectItem itemLabel="Seleccione" itemValue="#{null}"
													noSelectionOption="true" />
												<f:selectItem itemLabel="No Habilitado" itemValue="false"/>
												<f:selectItem itemLabel="Habilitado" itemValue="true"/>
											</p:selectOneMenu>
										</f:facet>
										<p:outputLabel value="Habilitado" rendered="#{perfil.estatus}" />
										<p:outputLabel value="Deshabilitado"
											rendered="#{!perfil.estatus}" />
									</p:column>

									<p:column headerText="Actualizar">
										<p:commandButton icon="pi pi-pencil" immediate="true"
											action="#{adminPerfilesController.cargarPerfil(perfil)}"
											oncomplete="PF('dlgPerfiles').show()"
											update="formAddUpdatePerfil:pblPerfiles" />
									</p:column>
								</p:dataTable>

							</div>
						</div>
					</div>
				</div>

				<ui:include src="/pages/commons/footer.xhtml" />
			</div>
		</h:form>



		<p:dialog id="dlgArtista" header="Agregar o actualizar perfil"
			widgetVar="dlgPerfiles" minHeight="40" responsive="true" width="50%"
			showEffect="fade" modal="true" resizable="false" height="500">

			<h:form id="formAddUpdatePerfil">

				<p:panelGrid id="pblPerfiles" columns="1" layout="grid"
					styleClass="ui-panelgrid-blank" columnClasses="ui-g-12">

					<p:outputLabel id="lblNombre" for="txtNombre" value="Nombre:" />
					<p:inputText id="txtNombre" required="true"
						requiredMessage="El nombre del perfil es requerido"
						value="#{adminPerfilesController.perfil.nombre}" />

					<p:outputLabel id="lblEstatus" value="Estatus:"
						rendered="#{adminPerfilesController.perfil.idRol != null}" />
					<p:inputSwitch id="inputEstatus"
						value="#{adminPerfilesController.perfil.estatus}"
						rendered="#{adminPerfilesController.perfil.idRol != null}" />

				</p:panelGrid>


				<p:panelGrid columns="2" layout="grid"
					styleClass="ui-panelgrid-blank" columnClasses="ui-g-6, ui-g-6">

					<p:commandButton value="Guardar" styleClass="ui-button-success"
						update="formPerfiles:messages, formAddUpdatePerfil:pblPerfiles, formPerfiles:tblPerfiles"
						action="#{adminPerfilesController.guardar}" />
					<p:commandButton value="Cancelar" styleClass="ui-button-danger"
						onclick="PF('dlgPerfiles').hide()" type="button" />

				</p:panelGrid>

			</h:form>
		</p:dialog>



	</div>
</h:body>


</html>