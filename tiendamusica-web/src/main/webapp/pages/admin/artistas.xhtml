<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">


<h:head>
	<ui:include src="/pages/commons/scripts.xhtml" />
</h:head>

<h:body>
	<div class="ui-fluid">
	
	<f:event type="preRenderView"
				listener="#{adminArtistasController.initializer}" />
				
		<h:form id="formArtistas">


			<p:growl id="messages" showSummary="true" showDetail="true"
				skipDetailIfEqualsSummary="true" />

			<ui:include src="/pages/commons/navbar.xhtml" />

			<div class="grid sample-layout">

				<div class="flex" style="width: 100%">
					<ui:include src="/pages/commons/header.xhtml" />


					<div class="col-8 flex-grow-1" style="background-color: black;">
						<div class="grid">
							<div class="col-12">

								<div class="col-2">
									<p:commandButton oncomplete="PF('dlgArtistas').show()"
										action="#{adminArtistasController.limpiarComponentes}"
										immediate="true" update="formAddUpdateArtista:pblArtistas"
										value="Agregar" />
								</div>


								<p:dataTable id="tblArtistas" var="artista"
									value="#{adminArtistasController.artistas}" rows="20"
									emptyMessage="No se encontraron registros de artistas..."
									paginator="true" rowsPerPageTemplate="20,50,100"
									paginatorPosition="bottom"
									filteredValue="#{adminArtistasController.artistasFiltrados}"
									paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
									currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros">

									<f:facet name="header">
										Listado de Artistas
									</f:facet>

									<p:column headerText="Imagen">
										<p:graphicImage name="images/artistas/#{artista.imagen}"
											width="100%" />
									</p:column>

									<p:column headerText="Nombre" filterBy="#{artista.nombre}"
										filterMatchMode="contains">
										<p:outputLabel value="#{artista.nombre}" />
									</p:column>


									<p:column headerText="Nacionalidad">
										<p:outputLabel value="#{artista.nacionalidad.descripcion}" />
									</p:column>

									<p:column headerText="Genero">
										<p:outputLabel value="#{artista.subGenero.genero.descripcion}" />
									</p:column>

									<p:column headerText="SubGenero">
										<p:outputLabel value="#{artista.subGenero.descripcion}" />
									</p:column>

									<p:column headerText="Estatus" filterBy="#{artista.estatus}">
										<p:outputLabel value="Habilitado"
											rendered="#{artista.estatus}" />
										<p:outputLabel value="Deshabilitado"
											rendered="#{!artista.estatus}" />
									</p:column>

									<p:column headerText="Actualizar">
										<p:commandButton icon="pi pi-pencil" immediate="true"
											action="#{adminArtistasController.cargarArtista(artista)}"
											oncomplete="PF('dlgArtistas').show()"
											update="formAddUpdateArtista:pblArtistas" />
									</p:column>
								</p:dataTable>



							</div>
						</div>
					</div>
				</div>

				<ui:include src="/pages/commons/footer.xhtml" />
			</div>
		</h:form>



		<p:dialog id="dlgArtista" header="Agregar o actualizar artista"
			widgetVar="dlgArtistas" minHeight="40" responsive="true" width="50%"
			showEffect="fade" modal="true" resizable="false" height="500">

			<h:form id="formAddUpdateArtista">

				<p:panelGrid id="pblArtistas" columns="1" layout="grid"
					styleClass="ui-panelgrid-blank" columnClasses="ui-g-12">


					<p:outputLabel id="lblNombre" for="txtNombre" value="Nombre:" />
					<p:inputText id="txtNombre" required="true"
						requiredMessage="El nombre del artista es requerido" value="#{adminArtistasController.artista.nombre}" />

					<p:outputLabel id="lblImagen" value="Imagen:" />
					<p:fileUpload mode="advanced" multiple="false"
						dragDropSupport="true" sizeLimit="102400"
						allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
						invalidSizeMessage="Maximum file size allowed is 100 KB"
						invalidFileMessage="only gif | jpg | jpeg | png is allowed"
						listener="#{adminArtistasController.handleFileUpload}"
						label="Buscar" update="opTextImage" />
					<p:outputPanel id="opTextImage">
						<p:outputLabel id="lblTextImage"
							value="Se ha cargado la imagen: #{adminArtistasController.uploadedFile.fileName}"
							rendered="#{adminArtistasController.uploadedFile != null}" />
					</p:outputPanel>

					<p:outputLabel id="lblNacionalidad" for="cboNacionalidad"
						value="Nacionalidad:" />
					<p:selectOneMenu id="cboNacionalidad" required="true"
						requiredMessage="La nacionalidad es requerida"
						value="#{adminArtistasController.artista.nacionalidad.idNacionalidad}">
						<f:selectItem itemValue="" itemLabel="Seleccione"></f:selectItem>
						<f:selectItems var="nacionalidad"
							value="#{adminArtistasController.nacionalidades}"
							itemValue="#{nacionalidad.idNacionalidad}"
							itemLabel="#{nacionalidad.descripcion}" />
					</p:selectOneMenu>

					<p:outputLabel id="lblGenero" for="cboGenero" value="Genero:" />
					<p:selectOneMenu id="cboGenero" required="true"
						requiredMessage="El genero es requerida" value="#{adminArtistasController.artista.subGenero.genero.idGenero}">
						<f:selectItem itemValue="" itemLabel="Seleccione"></f:selectItem>
						<f:selectItems var="genero"
							value="#{adminArtistasController.generos}"
							itemValue="#{genero.idGenero}"
							itemLabel="#{genero.descripcion}" />
							<p:ajax listener="#{adminArtistasController.consultarSubGenerosPorGenero}" update="cboSubGenero" />
					</p:selectOneMenu>

					<p:outputLabel id="lblSubGenero" for="cboSubGenero"
						value="SubGenero:" />
					<p:selectOneMenu id="cboSubGenero" required="true"
						requiredMessage="El subGenero es requerida" value="#{adminArtistasController.artista.subGenero.idSubGenero}">
						<f:selectItem itemValue="" itemLabel="Seleccione"></f:selectItem>
						<f:selectItems var="subGenero"
							value="#{adminArtistasController.subGeneros}"
							itemValue="#{subGenero.idSubGenero}"
							itemLabel="#{subGenero.descripcion}" />
					</p:selectOneMenu>

					<p:outputLabel id="lblEstatus" value="Estatus:"
						rendered="#{adminArtistasController.artista.idArtista != null}" />
					<p:inputSwitch id="inputEstatus"
						value="#{adminArtistasController.artista.estatus}"
						rendered="#{adminArtistasController.artista.idArtista != null}" />

				</p:panelGrid>


				<p:panelGrid columns="2" layout="grid"
					styleClass="ui-panelgrid-blank" columnClasses="ui-g-6, ui-g-6">

					<p:commandButton value="Guardar" styleClass="ui-button-success"
						update="formArtistas:messages, formAddUpdateArtista:pblArtistas, formArtistas:tblArtistas"
						action="#{adminArtistasController.guardar}" />
					<p:commandButton value="Cancelar" styleClass="ui-button-danger"
						onclick="PF('dlgArtistas').hide()" type="button" />

				</p:panelGrid>

			</h:form>
		</p:dialog>



	</div>
</h:body>


</html>